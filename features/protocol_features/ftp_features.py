from u_utils import common_models, enumerated_field
from scripts.utils import get_field
from scripts.const import ports_and_protocols

ftp_server_list = {s.lower() for s in [
    'amazon',
    'blah',
    'Cerberus',
    'CompleteFTP',
    'CrushFTP',
    'check point',
    'dreamhost',
    'FileZilla',
    'Microsoft',
    'NASLite',
    'nasftp',
    'Sysax',
    'serv-u',
    'Titan',
    'glFTPd',
    'ProFTPD',
    'Pure-FTPd',
    'vsftpd',
    'wu-ftpd',
    'WS FTP',
    'War',
]}

banners = [
    '220',
    '220 proftpd',
    '220 (vsftpd',
    '220 check point firewall-1 secure ftp server running on',
    '220 filezilla server version 0.9.41 beta',
    '220 ftp firmware update utility',
    '220 ftp server ready',
    '220 ftp service ready',
    '220 microsoft ftp service',
    '220-filezilla server 0.9.60 beta',
]


def meta_features(machine, field_preifx):
    res = []
    res += enumerated_field(machine,
                            '{}_banner'.format(field_preifx),
                            banners)
    banner = get_field(machine, '{}_banner'.format(field_preifx), t='str')
    res += common_models(machine, field_preifx, ftp_server_list, add_str=banner)
    return res


def extract(machine, args):
    res = []
    protocol = 'ftp'
    ports = [p for c in ports_and_protocols
             if c[0] == protocol
             for p in c[1]]
    for port in sorted(ports, reverse=True):
        field_prefix = 'p{}_{}_banner'.format(port, protocol)
        res += meta_features(machine, field_prefix)
    return res


def main():
    import json
    from scripts.utils import recurse_machine_fields
    machine = recurse_machine_fields(json.loads("""{"p995":{"pop3s":{"tls":{"tls":{"server_key_exchange":{"ecdh_params":{"curve_id":{"id":24,"name":"secp384r1"}}},"certificate":{"parsed":{"fingerprint_sha1":"53449554e82cc3c57293dd02fb9041c7487c392e","tbs_noct_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"bdfd4ba3c92480cc0a7f7956bd78cc2dff8a452572e2388ebaf74377c6d087fd","version":3,"extensions":{"authority_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea","basic_constraints":{"is_ca":true},"subject_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"15946260802839569540","fingerprint_md5":"c82a475f7e4bbb6607114231497fff36","subject_key_info":{"fingerprint_sha256":"fbc7bc533192623fad48214831a9cdc1b420e5e24a1eb43467fd8f7486b31bc2","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"nNUCxZDXq2pBx5y9nid70L0brJEl84W/a7KrTIek8qBsUMQCxkjI1A0+HwmEZ0+QZirbh3VYv408f1DqiX7jhmUF1CCJMVyVH+vjm10FXEDz0WviHrgUjGIUgEDPlw1rf0WoNO/syN2JREZooFza2KX+C9DYy+3eBDkhx4Ep5/2xJjwJ2llyAsH8lX2CDHgd9/bRKwiEST0VRerzLsSWdZPdogmiImz9SrAImVDSu56D+yHrVLeyOtK+9HL/OGJGHdKUQJSqw8WFn5wDnsuuLH741nTBq+dtTL052pL4EpinSC+2IbgRvAyMBMAsyIabMGEOO5cytPvtlYGKhxmrtQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"ShhZecH4f7jV5chhcWVIJHGAyTh38ostoxNmURLckeYSsKHOqMYG9cWvDUcYiuTVfnkgtfPB2L4Amn+A9VVn/x0yuYzOaAPaRWAHsyrN/5vFZrWGA0hvYLKaisDD9Rn/bRQX8K7EiN918JJ/8KDEA/Bi4UWQQTtUix68+bNQRJSBwtLvawrOcjEc1pc82kItyVNx+K/4TpOYgUqyzthLGzMuEfhx48yysmoOAOt3KlDP5b0YOd3KCkHEIos8D/cW/XQ/plOWEhJ+rvOE5lZOgDSf9kahRfPRhBJx3xM2uX72EeK+LrDtVmpSlsnNiND0cAGqrxW7E05aboTIGvKN4A==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"08cc59c75b3d487fd6091ae77a7154e716ecce276e7e336410b0f26148d39ea4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"cipher_suite":{"id":"0xC02F","name":"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"},"version":"TLSv1.2","ocsp_stapling":false,"signature":{"hash_algorithm":"sha512","valid":true,"signature_algorithm":"rsa"},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"}},"banner":"+OK Dovecot DA ready.","metadata":{}}}},"p25":{"smtp":{"starttls":{"ehlo":"250-ns301697.ip-94-23-53.eu Hello CLIENT_HOSTNAME [CLIENT_IP] 250-SIZE 20971520 250-8BITMIME 250-PIPELINING 250-AUTH PLAIN LOGIN 250-STARTTLS 250 HELP","tls":{"cipher_suite":{"id":"0x0005","name":"TLS_RSA_WITH_RC4_128_SHA"},"version":"TLSv1.2","ocsp_stapling":false,"certificate":{"parsed":{"fingerprint_sha1":"53449554e82cc3c57293dd02fb9041c7487c392e","tbs_noct_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"bdfd4ba3c92480cc0a7f7956bd78cc2dff8a452572e2388ebaf74377c6d087fd","version":3,"extensions":{"authority_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea","basic_constraints":{"is_ca":true},"subject_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"15946260802839569540","fingerprint_md5":"c82a475f7e4bbb6607114231497fff36","subject_key_info":{"fingerprint_sha256":"fbc7bc533192623fad48214831a9cdc1b420e5e24a1eb43467fd8f7486b31bc2","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"nNUCxZDXq2pBx5y9nid70L0brJEl84W/a7KrTIek8qBsUMQCxkjI1A0+HwmEZ0+QZirbh3VYv408f1DqiX7jhmUF1CCJMVyVH+vjm10FXEDz0WviHrgUjGIUgEDPlw1rf0WoNO/syN2JREZooFza2KX+C9DYy+3eBDkhx4Ep5/2xJjwJ2llyAsH8lX2CDHgd9/bRKwiEST0VRerzLsSWdZPdogmiImz9SrAImVDSu56D+yHrVLeyOtK+9HL/OGJGHdKUQJSqw8WFn5wDnsuuLH741nTBq+dtTL052pL4EpinSC+2IbgRvAyMBMAsyIabMGEOO5cytPvtlYGKhxmrtQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"ShhZecH4f7jV5chhcWVIJHGAyTh38ostoxNmURLckeYSsKHOqMYG9cWvDUcYiuTVfnkgtfPB2L4Amn+A9VVn/x0yuYzOaAPaRWAHsyrN/5vFZrWGA0hvYLKaisDD9Rn/bRQX8K7EiN918JJ/8KDEA/Bi4UWQQTtUix68+bNQRJSBwtLvawrOcjEc1pc82kItyVNx+K/4TpOYgUqyzthLGzMuEfhx48yysmoOAOt3KlDP5b0YOd3KCkHEIos8D/cW/XQ/plOWEhJ+rvOE5lZOgDSf9kahRfPRhBJx3xM2uX72EeK+LrDtVmpSlsnNiND0cAGqrxW7E05aboTIGvKN4A==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"08cc59c75b3d487fd6091ae77a7154e716ecce276e7e336410b0f26148d39ea4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"}},"metadata":{"product":"Exim","description":"Exim"},"banner":"220 ns301697.ip-94-23-53.eu ESMTP Exim 4.84 Sun, 17 Mar 2019 00:07:09 +0100","starttls":"220 TLS go ahead"}}},"p21":{"ftp":{"banner":{"banner":"220 ProFTPD 1.3.4b Server ready.","metadata":{"product":"ProFTPD","version":"1.3.4","description":"ProFTPD 1.3.4 b","revision":"b"}}}},"p22":{"ssh":{"v2":{"key_exchange":{"dh_params":{"prime":{"length":2048,"value":"///////////JD9qiIWjCNMTGYouA3BzRKQJOCIpnzHQCC76mOxObIlFKCHmONATd75UZs806QxswKwpt8l8UN0/hNW1tUcJF5IW1dmJefsb0TELppjftawv/XLb0Brft7jhr+1qJn6WunyQRfEsf5kkoZlHs5Fs9wgB8uKFjvwWY2kg2HFXTmmkWP6j9JM9fg2VdI9yjrZYcYvNWIIVSu57VKQdwlpZtZww1Tkq8mATxdGwIyhghfDKQXkYuNs474553LBgOhgObJ4Oi7Aeij7XFXfBvTFLJ3ivL9pVYFxg5lUl86pVq5RXSJhiY+gUQFXKOWoqsqmj//////////w=="},"generator":{"length":8,"value":"Ag=="}}},"support":{"host_key_algorithms":["ssh-rsa","ssh-dss"],"first_kex_follows":false,"client_to_server":{"ciphers":["aes128-ctr","aes192-ctr","aes256-ctr","arcfour256","arcfour128","aes128-cbc","3des-cbc","blowfish-cbc","cast128-cbc","aes192-cbc","aes256-cbc","arcfour","rijndael-cbc@lysator.liu.se"],"macs":["hmac-md5","hmac-sha1","umac-64@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-ripemd160","hmac-ripemd160@openssh.com","hmac-sha1-96","hmac-md5-96"],"compressions":["none","zlib@openssh.com"]},"kex_algorithms":["diffie-hellman-group-exchange-sha256","diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"],"server_to_client":{"ciphers":["aes128-ctr","aes192-ctr","aes256-ctr","arcfour256","arcfour128","aes128-cbc","3des-cbc","blowfish-cbc","cast128-cbc","aes192-cbc","aes256-cbc","arcfour","rijndael-cbc@lysator.liu.se"],"macs":["hmac-md5","hmac-sha1","umac-64@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-ripemd160","hmac-ripemd160@openssh.com","hmac-sha1-96","hmac-md5-96"],"compressions":["none","zlib@openssh.com"]}},"selected":{"host_key_algorithm":"ssh-rsa","server_to_client":{"mac":"hmac-sha2-256","cipher":"aes128-ctr","compression":"none"},"client_to_server":{"mac":"hmac-sha2-256","cipher":"aes128-ctr","compression":"none"},"kex_algorithm":"diffie-hellman-group14-sha1"},"server_host_key":{"fingerprint_sha256":"4c82e929add953f9fdcb276a46467dcbce15b40a140ec5e71eded6199a25f343","key_algorithm":"ssh-rsa","rsa_public_key":{"length":2048,"modulus":"71ISUW/6Yk+rkVnqH37S2UM9i3K+4YG4jaegK1DkagUDz+qRi7Lyz4qpDci424ATfG16cnMqbxHv/VdGhsfhyEohB0N1zWC/YuQktLXcuQ1QjB1tGjtxTZplcXcC0g3VF36E60Pm8fsXL51JUW1ElBp11CgyM0+kUJ3KwrIKnWtej6bW08zqREUd/N9Q4XonQd1nj7NoS/cMwuNcdy6XcaefTJ4kEKSoueYYMnQYkJcbxIFKT2TfI7HwimwHn8OURe8uWDCtb8zO3myKFqsECs1HziKnADy/2IEFsCijuhkm09jhY9FNrxksyoM+i0gh+aXtPoMB2bqysdoZuzPRuw==","exponent":65537}},"banner":{"raw":"SSH-2.0-OpenSSH_5.3","version":"2.0","software":"OpenSSH_5.3"},"metadata":{"product":"OpenSSH","version":"5.3","description":"OpenSSH 5.3"}}}},"p587":{"smtp":{"starttls":{"ehlo":"250-ns301697.ip-94-23-53.eu Hello CLIENT_HOSTNAME [CLIENT_IP] 250-SIZE 20971520 250-8BITMIME 250-PIPELINING 250-AUTH PLAIN LOGIN 250-STARTTLS 250 HELP","tls":{"cipher_suite":{"id":"0x0005","name":"TLS_RSA_WITH_RC4_128_SHA"},"version":"TLSv1.2","ocsp_stapling":false,"certificate":{"parsed":{"fingerprint_sha1":"53449554e82cc3c57293dd02fb9041c7487c392e","tbs_noct_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"bdfd4ba3c92480cc0a7f7956bd78cc2dff8a452572e2388ebaf74377c6d087fd","version":3,"extensions":{"authority_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea","basic_constraints":{"is_ca":true},"subject_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"15946260802839569540","fingerprint_md5":"c82a475f7e4bbb6607114231497fff36","subject_key_info":{"fingerprint_sha256":"fbc7bc533192623fad48214831a9cdc1b420e5e24a1eb43467fd8f7486b31bc2","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"nNUCxZDXq2pBx5y9nid70L0brJEl84W/a7KrTIek8qBsUMQCxkjI1A0+HwmEZ0+QZirbh3VYv408f1DqiX7jhmUF1CCJMVyVH+vjm10FXEDz0WviHrgUjGIUgEDPlw1rf0WoNO/syN2JREZooFza2KX+C9DYy+3eBDkhx4Ep5/2xJjwJ2llyAsH8lX2CDHgd9/bRKwiEST0VRerzLsSWdZPdogmiImz9SrAImVDSu56D+yHrVLeyOtK+9HL/OGJGHdKUQJSqw8WFn5wDnsuuLH741nTBq+dtTL052pL4EpinSC+2IbgRvAyMBMAsyIabMGEOO5cytPvtlYGKhxmrtQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"ShhZecH4f7jV5chhcWVIJHGAyTh38ostoxNmURLckeYSsKHOqMYG9cWvDUcYiuTVfnkgtfPB2L4Amn+A9VVn/x0yuYzOaAPaRWAHsyrN/5vFZrWGA0hvYLKaisDD9Rn/bRQX8K7EiN918JJ/8KDEA/Bi4UWQQTtUix68+bNQRJSBwtLvawrOcjEc1pc82kItyVNx+K/4TpOYgUqyzthLGzMuEfhx48yysmoOAOt3KlDP5b0YOd3KCkHEIos8D/cW/XQ/plOWEhJ+rvOE5lZOgDSf9kahRfPRhBJx3xM2uX72EeK+LrDtVmpSlsnNiND0cAGqrxW7E05aboTIGvKN4A==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"08cc59c75b3d487fd6091ae77a7154e716ecce276e7e336410b0f26148d39ea4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"}},"metadata":{"product":"Exim","description":"Exim"},"banner":"220 ns301697.ip-94-23-53.eu ESMTP Exim 4.84 Sat, 16 Mar 2019 08:20:20 +0100","starttls":"220 TLS go ahead"}}},"p443":{"https":{"tls":{"server_key_exchange":{"ecdh_params":{"curve_id":{"id":23,"name":"secp256r1"}}},"certificate":{"parsed":{"fingerprint_sha1":"de65c9c15df103de4dbde815a73f38f5a3bf74c9","tbs_noct_fingerprint":"0baddf3e65aef9d05351f4c5f00211881f09bdee90ab9fe29ca7a8b200e99723","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"0baddf3e65aef9d05351f4c5f00211881f09bdee90ab9fe29ca7a8b200e99723","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"b97f66f0fb550dc73a3774c8ff1f831bd92ccee59e80c1ab79c80cf84cd6dd83","version":3,"extensions":{"authority_key_id":"7a402c18895487c51fa7130076c8688456e18639","basic_constraints":{"is_ca":true},"subject_key_id":"7a402c18895487c51fa7130076c8688456e18639"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"14091611855861384554","fingerprint_md5":"548077ca9ea78268df26b8e81b11f466","subject_key_info":{"fingerprint_sha256":"64a719c1c9220ed0b3cd6cfa2155e30d5417517a160438f084644881a78fed87","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"xBrLEDZ11vJxu+RwBYvyLYLC0JPyHsnyx7YqG5vSaU2TBJkakycpR+52wcgjT7TeG7UTriNWPmsi7DYM7OszMVsaR28h+FOZpuRByMEU8Ya11WO09sh01HHt8UFGiCuKWdfbty7NL33TyVW06gpl7Es7TtyjQgCQUy4FgbjDhD9ZQeJAEMI0nSYpw8PEy12b3USgdLzIh0RLOfcLKBrGGnAq1NCnCE4RLx7kes/WElw/h10CCkXrEoK1owng0c6cjIGEqKi5rrjKU21bTumGc+eajwBoZYdy/edRnuv0Tyd2+kg2gLouPB3rg/xTni7j1a7HAtUXyFMBk2Ny3td1tQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"fyfIIYRPDtp5Ihg4HMOIMpB/4mryIpveKqoBZD78KnPO6th45iDshFEmcp+t7LWaaU9KOI8K8QB6Ec4g8wBB6efZTTxxyPKcPCa5Y8PHZXkA1Xc2pXux+Km6iiHZc2Yb5kwAXQYyMiSQrRS0RnSF/c6UEH3hD2icYF57G2FRID+V6NdhH/QDmqdK0DW20dmMET3X7OzwYrmFlPUDGld431a8Pk1eRjezf+kpYDZwM6MGPeohfELOi13nnb1H2xn1ejnx2d7TvFtEOb9H4tkP4MNLVpA1PY0dXCn5FSGEZG3xorjYgQ4T2/IU0hXIFtfTNBPJZcaLqtm9G62doMPgKQ==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"f478c9eb971d5fc295c4f1fc542fd7bc8664b86bcc77e309e4e83c1a7a5c40c4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"cipher_suite":{"id":"0xC014","name":"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA"},"version":"TLSv1.2","session_ticket":{"length":192,"lifetime_hint":300},"signature":{"hash_algorithm":"sha512","valid":true,"signature_algorithm":"rsa"},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"},"ocsp_stapling":false,"metadata":{}},"dhe_export":{"support":false,"metadata":{}},"get":{"body":"<html>Apache is functioning normally</html>","body_sha256":"9e57007b15edab321b71b57c500e3d677eeb54fb37017527dae0a5e52358eb69","status_code":200,"status_line":"200 OK","headers":{"unknown":[{"key":"etag","value":"6078b-2c-508e9f0fb10bb"},{"key":"date","value":"Tue, 19 Mar 2019 20:55:41 GMT"}],"vary":"Accept-Encoding,User-Agent","server":"Apache/2","last_modified":"Fri, 28 Nov 2014 11:55:46 GMT","content_type":"text/html","accept_ranges":"bytes"},"metadata":{"product":"httpd","version":"2","description":"Apache httpd 2","manufacturer":"Apache"}},"dhe":{"support":true,"dh_params":{"prime":{"length":2048,"value":"///////////JD9qiIWjCNMTGYouA3BzRKQJOCIpnzHQCC76mOxObIlFKCHmONATd75UZs806QxswKwpt8l8UN0/hNW1tUcJF5IW1dmJefsb0TELppjftawv/XLb0Brft7jhr+1qJn6WunyQRfEsf5kkoZlHs5Fs9wgB8uKFjvwWY2kg2HFXTmmkWP6j9JM9fg2VdI9yjrZYcYvNWIIVSu57VKQdwlpZtZww1Tkq8mATxdGwIyhghfDKQXkYuNs474553LBgOhgObJ4Oi7Aeij7XFXfBvTFLJ3ivL9pVYFxg5lUl86pVq5RXSJhiY+gUQFXKOWoqsqmj//////////w=="},"generator":{"length":8,"value":"Ag=="}},"metadata":{}},"heartbleed":{"heartbeat_enabled":true,"heartbleed_vulnerable":false,"metadata":{}},"rsa_export":{"support":false,"metadata":{}}}},"ip":"94.23.53.137","p143":{"imap":{"starttls":{"tls":{"server_key_exchange":{"ecdh_params":{"curve_id":{"id":24,"name":"secp384r1"}}},"certificate":{"parsed":{"fingerprint_sha1":"53449554e82cc3c57293dd02fb9041c7487c392e","tbs_noct_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"bdfd4ba3c92480cc0a7f7956bd78cc2dff8a452572e2388ebaf74377c6d087fd","version":3,"extensions":{"authority_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea","basic_constraints":{"is_ca":true},"subject_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"15946260802839569540","fingerprint_md5":"c82a475f7e4bbb6607114231497fff36","subject_key_info":{"fingerprint_sha256":"fbc7bc533192623fad48214831a9cdc1b420e5e24a1eb43467fd8f7486b31bc2","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"nNUCxZDXq2pBx5y9nid70L0brJEl84W/a7KrTIek8qBsUMQCxkjI1A0+HwmEZ0+QZirbh3VYv408f1DqiX7jhmUF1CCJMVyVH+vjm10FXEDz0WviHrgUjGIUgEDPlw1rf0WoNO/syN2JREZooFza2KX+C9DYy+3eBDkhx4Ep5/2xJjwJ2llyAsH8lX2CDHgd9/bRKwiEST0VRerzLsSWdZPdogmiImz9SrAImVDSu56D+yHrVLeyOtK+9HL/OGJGHdKUQJSqw8WFn5wDnsuuLH741nTBq+dtTL052pL4EpinSC+2IbgRvAyMBMAsyIabMGEOO5cytPvtlYGKhxmrtQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"ShhZecH4f7jV5chhcWVIJHGAyTh38ostoxNmURLckeYSsKHOqMYG9cWvDUcYiuTVfnkgtfPB2L4Amn+A9VVn/x0yuYzOaAPaRWAHsyrN/5vFZrWGA0hvYLKaisDD9Rn/bRQX8K7EiN918JJ/8KDEA/Bi4UWQQTtUix68+bNQRJSBwtLvawrOcjEc1pc82kItyVNx+K/4TpOYgUqyzthLGzMuEfhx48yysmoOAOt3KlDP5b0YOd3KCkHEIos8D/cW/XQ/plOWEhJ+rvOE5lZOgDSf9kahRfPRhBJx3xM2uX72EeK+LrDtVmpSlsnNiND0cAGqrxW7E05aboTIGvKN4A==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"08cc59c75b3d487fd6091ae77a7154e716ecce276e7e336410b0f26148d39ea4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"cipher_suite":{"id":"0xC02F","name":"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"},"version":"TLSv1.2","ocsp_stapling":false,"signature":{"hash_algorithm":"sha512","valid":true,"signature_algorithm":"rsa"},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"}},"metadata":{"product":"Dovecot","description":"Dovecot"},"banner":"* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE STARTTLS AUTH=PLAIN] Dovecot DA ready.","starttls":"a001 OK Begin TLS negotiation now."}}},"tags":["pop3","ftp","dns","http","ssh","https","pop3s","smtp","imap","imaps"],"updated_at":"2019-03-20T08:14:28+00:00","p53":{"dns":{"lookup":{"resolves_correctly":false,"support":true,"open_resolver":false,"answers":[],"errors":false,"additionals":[],"questions":[{"type":"A","name":"c.afekv.com"}],"authorities":[],"metadata":{}}}},"autonomous_system":{"description":"OVH","rir":"unknown","routed_prefix":"94.23.0.0/16","country_code":"FR","path":[16276],"asn":16276,"name":"OVH"},"p465":{"smtp":{"tls":{"ehlo":"250-ns301697.ip-94-23-53.eu Hello CLIENT_HOSTNAME [CLIENT_IP] 250-SIZE 20971520 250-8BITMIME 250-PIPELINING 250-AUTH PLAIN LOGIN 250 HELP","tls":{"cipher_suite":{"id":"0x0005","name":"TLS_RSA_WITH_RC4_128_SHA"},"version":"TLSv1.2","ocsp_stapling":false,"certificate":{"parsed":{"fingerprint_sha1":"53449554e82cc3c57293dd02fb9041c7487c392e","tbs_noct_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"bdfd4ba3c92480cc0a7f7956bd78cc2dff8a452572e2388ebaf74377c6d087fd","version":3,"extensions":{"authority_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea","basic_constraints":{"is_ca":true},"subject_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"15946260802839569540","fingerprint_md5":"c82a475f7e4bbb6607114231497fff36","subject_key_info":{"fingerprint_sha256":"fbc7bc533192623fad48214831a9cdc1b420e5e24a1eb43467fd8f7486b31bc2","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"nNUCxZDXq2pBx5y9nid70L0brJEl84W/a7KrTIek8qBsUMQCxkjI1A0+HwmEZ0+QZirbh3VYv408f1DqiX7jhmUF1CCJMVyVH+vjm10FXEDz0WviHrgUjGIUgEDPlw1rf0WoNO/syN2JREZooFza2KX+C9DYy+3eBDkhx4Ep5/2xJjwJ2llyAsH8lX2CDHgd9/bRKwiEST0VRerzLsSWdZPdogmiImz9SrAImVDSu56D+yHrVLeyOtK+9HL/OGJGHdKUQJSqw8WFn5wDnsuuLH741nTBq+dtTL052pL4EpinSC+2IbgRvAyMBMAsyIabMGEOO5cytPvtlYGKhxmrtQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"ShhZecH4f7jV5chhcWVIJHGAyTh38ostoxNmURLckeYSsKHOqMYG9cWvDUcYiuTVfnkgtfPB2L4Amn+A9VVn/x0yuYzOaAPaRWAHsyrN/5vFZrWGA0hvYLKaisDD9Rn/bRQX8K7EiN918JJ/8KDEA/Bi4UWQQTtUix68+bNQRJSBwtLvawrOcjEc1pc82kItyVNx+K/4TpOYgUqyzthLGzMuEfhx48yysmoOAOt3KlDP5b0YOd3KCkHEIos8D/cW/XQ/plOWEhJ+rvOE5lZOgDSf9kahRfPRhBJx3xM2uX72EeK+LrDtVmpSlsnNiND0cAGqrxW7E05aboTIGvKN4A==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"08cc59c75b3d487fd6091ae77a7154e716ecce276e7e336410b0f26148d39ea4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"}},"banner":"220 ns301697.ip-94-23-53.eu ESMTP Exim 4.84 Tue, 19 Mar 2019 03:24:10 +0100","metadata":{}}}},"location":{"country":"France","longitude":2.3387,"registered_country":"France","registered_country_code":"FR","country_code":"FR","latitude":48.8582,"timezone":"Europe/Paris","continent":"Europe"},"p80":{"http":{"get":{"body":"<html>Apache is functioning normally</html>","body_sha256":"9e57007b15edab321b71b57c500e3d677eeb54fb37017527dae0a5e52358eb69","status_code":200,"status_line":"200 OK","headers":{"unknown":[{"key":"etag","value":"6078b-2c-508e9f0fb10bb"},{"key":"date","value":"Tue, 19 Mar 2019 22:29:20 GMT"}],"vary":"Accept-Encoding,User-Agent","server":"Apache/2","last_modified":"Fri, 28 Nov 2014 11:55:46 GMT","content_type":"text/html","accept_ranges":"bytes"},"metadata":{"product":"httpd","version":"2","description":"Apache httpd 2","manufacturer":"Apache"}}}},"p993":{"imaps":{"tls":{"tls":{"server_key_exchange":{"ecdh_params":{"curve_id":{"id":24,"name":"secp384r1"}}},"certificate":{"parsed":{"fingerprint_sha1":"53449554e82cc3c57293dd02fb9041c7487c392e","tbs_noct_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"bdfd4ba3c92480cc0a7f7956bd78cc2dff8a452572e2388ebaf74377c6d087fd","version":3,"extensions":{"authority_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea","basic_constraints":{"is_ca":true},"subject_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"15946260802839569540","fingerprint_md5":"c82a475f7e4bbb6607114231497fff36","subject_key_info":{"fingerprint_sha256":"fbc7bc533192623fad48214831a9cdc1b420e5e24a1eb43467fd8f7486b31bc2","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"nNUCxZDXq2pBx5y9nid70L0brJEl84W/a7KrTIek8qBsUMQCxkjI1A0+HwmEZ0+QZirbh3VYv408f1DqiX7jhmUF1CCJMVyVH+vjm10FXEDz0WviHrgUjGIUgEDPlw1rf0WoNO/syN2JREZooFza2KX+C9DYy+3eBDkhx4Ep5/2xJjwJ2llyAsH8lX2CDHgd9/bRKwiEST0VRerzLsSWdZPdogmiImz9SrAImVDSu56D+yHrVLeyOtK+9HL/OGJGHdKUQJSqw8WFn5wDnsuuLH741nTBq+dtTL052pL4EpinSC+2IbgRvAyMBMAsyIabMGEOO5cytPvtlYGKhxmrtQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"ShhZecH4f7jV5chhcWVIJHGAyTh38ostoxNmURLckeYSsKHOqMYG9cWvDUcYiuTVfnkgtfPB2L4Amn+A9VVn/x0yuYzOaAPaRWAHsyrN/5vFZrWGA0hvYLKaisDD9Rn/bRQX8K7EiN918JJ/8KDEA/Bi4UWQQTtUix68+bNQRJSBwtLvawrOcjEc1pc82kItyVNx+K/4TpOYgUqyzthLGzMuEfhx48yysmoOAOt3KlDP5b0YOd3KCkHEIos8D/cW/XQ/plOWEhJ+rvOE5lZOgDSf9kahRfPRhBJx3xM2uX72EeK+LrDtVmpSlsnNiND0cAGqrxW7E05aboTIGvKN4A==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"08cc59c75b3d487fd6091ae77a7154e716ecce276e7e336410b0f26148d39ea4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"cipher_suite":{"id":"0xC02F","name":"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"},"version":"TLSv1.2","ocsp_stapling":false,"signature":{"hash_algorithm":"sha512","valid":true,"signature_algorithm":"rsa"},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"}},"banner":"* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN] Dovecot DA ready.","metadata":{}}}},"ports":[993,995,587,110,143,80,465,21,22,25,443,53],"protocols":["80/http","993/imaps","465/smtp","995/pop3s","25/smtp","110/pop3","21/ftp","143/imap","53/dns","587/smtp","443/https","22/ssh"],"p110":{"pop3":{"starttls":{"tls":{"server_key_exchange":{"ecdh_params":{"curve_id":{"id":24,"name":"secp384r1"}}},"certificate":{"parsed":{"fingerprint_sha1":"53449554e82cc3c57293dd02fb9041c7487c392e","tbs_noct_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","subject_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","issuer":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]},"tbs_fingerprint":"2785c0e4697029a143bf35d518325941436db1b6ea8cac531411e671a42eed41","redacted":false,"validation_level":"unknown","issuer_dn":"C=--, ST=France, L=rbx2, O=OVH, OU=--, CN=ns301697.ip-94-23-53.eu, emailAddress=root@ns301697.ip-94-23-53.eu","fingerprint_sha256":"bdfd4ba3c92480cc0a7f7956bd78cc2dff8a452572e2388ebaf74377c6d087fd","version":3,"extensions":{"authority_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea","basic_constraints":{"is_ca":true},"subject_key_id":"f7451a2ecdc26371a4a1fad201d7420925bf7fea"},"names":["ns301697.ip-94-23-53.eu"],"signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"},"validity":{"start":"2014-11-28T12:04:16Z","length":863913600,"end":"2042-04-14T12:04:16Z"},"serial_number":"15946260802839569540","fingerprint_md5":"c82a475f7e4bbb6607114231497fff36","subject_key_info":{"fingerprint_sha256":"fbc7bc533192623fad48214831a9cdc1b420e5e24a1eb43467fd8f7486b31bc2","key_algorithm":{"name":"RSA"},"rsa_public_key":{"length":2048,"modulus":"nNUCxZDXq2pBx5y9nid70L0brJEl84W/a7KrTIek8qBsUMQCxkjI1A0+HwmEZ0+QZirbh3VYv408f1DqiX7jhmUF1CCJMVyVH+vjm10FXEDz0WviHrgUjGIUgEDPlw1rf0WoNO/syN2JREZooFza2KX+C9DYy+3eBDkhx4Ep5/2xJjwJ2llyAsH8lX2CDHgd9/bRKwiEST0VRerzLsSWdZPdogmiImz9SrAImVDSu56D+yHrVLeyOtK+9HL/OGJGHdKUQJSqw8WFn5wDnsuuLH741nTBq+dtTL052pL4EpinSC+2IbgRvAyMBMAsyIabMGEOO5cytPvtlYGKhxmrtQ==","exponent":65537}},"signature":{"self_signed":true,"valid":true,"value":"ShhZecH4f7jV5chhcWVIJHGAyTh38ostoxNmURLckeYSsKHOqMYG9cWvDUcYiuTVfnkgtfPB2L4Amn+A9VVn/x0yuYzOaAPaRWAHsyrN/5vFZrWGA0hvYLKaisDD9Rn/bRQX8K7EiN918JJ/8KDEA/Bi4UWQQTtUix68+bNQRJSBwtLvawrOcjEc1pc82kItyVNx+K/4TpOYgUqyzthLGzMuEfhx48yysmoOAOt3KlDP5b0YOd3KCkHEIos8D/cW/XQ/plOWEhJ+rvOE5lZOgDSf9kahRfPRhBJx3xM2uX72EeK+LrDtVmpSlsnNiND0cAGqrxW7E05aboTIGvKN4A==","signature_algorithm":{"oid":"1.2.840.113549.1.1.11","name":"SHA256WithRSA"}},"spki_subject_fingerprint":"08cc59c75b3d487fd6091ae77a7154e716ecce276e7e336410b0f26148d39ea4","subject":{"province":["France"],"locality":["rbx2"],"country":["--"],"organizational_unit":["--"],"common_name":["ns301697.ip-94-23-53.eu"],"organization":["OVH"],"email_address":["root@ns301697.ip-94-23-53.eu"]}}},"cipher_suite":{"id":"0xC02F","name":"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"},"version":"TLSv1.2","ocsp_stapling":false,"signature":{"hash_algorithm":"sha512","valid":true,"signature_algorithm":"rsa"},"validation":{"browser_trusted":false,"browser_error":"x509: unknown error"}},"metadata":{"product":"Dovecot","description":"Dovecot"},"banner":"+OK Dovecot DA ready.","starttls":"+OK Begin TLS negotiation now."}}}}"""))
    args = {
        'domain': 'verifone.com',
        'c_id': 'verifone',
        'date': '20170215'
    }
    result = extract(machine, args)
    # print([r.get_all() for r in result])
    from scripts.utils import compare_feature_output
    compare_feature_output([r.get_all() for r in result],[{'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_CHECK_POINT_FIREWALL-1_SECURE_FTP_SERVER_RUNNI', 'description': 'is p21_ftp_banner_banner 220 check point firewall-1 secure ftp server running on?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_MICROSOFT_FTP_SERVICE', 'description': 'is p21_ftp_banner_banner 220 microsoft ftp service?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_FTP_FIRMWARE_UPDATE_UTILITY', 'description': 'is p21_ftp_banner_banner 220 ftp firmware update utility?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_FTP_SERVICE_READY.', 'description': 'is p21_ftp_banner_banner 220 ftp service ready.?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_UNKNOWN', 'description': 'is p21_ftp_banner_banner unknown?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_FILEZILLA_SERVER_VERSION_0.9.41_BETA', 'description': 'is p21_ftp_banner_banner 220 filezilla server version 0.9.41 beta?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_PROFTPD', 'description': 'is p21_ftp_banner_banner 220 proftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_FTP_SERVER_READY.', 'description': 'is p21_ftp_banner_banner 220 ftp server ready.?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220-FILEZILLA_SERVER_0.9.60_BETA', 'description': 'is p21_ftp_banner_banner 220-filezilla server 0.9.60 beta?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220_(VSFTPD_', 'description': 'is p21_ftp_banner_banner 220 (vsftpd ?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_BANNER_220', 'description': 'is p21_ftp_banner_banner 220?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_CHECK_POINT', 'description': 'is p21_ftp_banner running check point?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_TITAN', 'description': 'is p21_ftp_banner running titan?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_PURE-FTPD', 'description': 'is p21_ftp_banner running pure-ftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_CRUSHFTP', 'description': 'is p21_ftp_banner running crushftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_NASLITE', 'description': 'is p21_ftp_banner running naslite?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_PROFTPD', 'description': 'is p21_ftp_banner running proftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_WS_FTP', 'description': 'is p21_ftp_banner running ws ftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_MICROSOFT', 'description': 'is p21_ftp_banner running microsoft?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_WU-FTPD', 'description': 'is p21_ftp_banner running wu-ftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_WAR', 'description': 'is p21_ftp_banner running war?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_FILEZILLA', 'description': 'is p21_ftp_banner running filezilla?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_SERV-U', 'description': 'is p21_ftp_banner running serv-u?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_BLAH', 'description': 'is p21_ftp_banner running blah?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_AMAZON', 'description': 'is p21_ftp_banner running amazon?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_VSFTPD', 'description': 'is p21_ftp_banner running vsftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_DREAMHOST', 'description': 'is p21_ftp_banner running dreamhost?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_GLFTPD', 'description': 'is p21_ftp_banner running glftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_NASFTP', 'description': 'is p21_ftp_banner running nasftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_CERBERUS', 'description': 'is p21_ftp_banner running cerberus?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_COMPLETEFTP', 'description': 'is p21_ftp_banner running completeftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P21_FTP_BANNER_RUNNING_SYSAX', 'description': 'is p21_ftp_banner running sysax?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_CHECK_POINT_FIREWALL-1_SECURE_FTP_SERVER_RUNNI', 'description': 'is p20_ftp_banner_banner 220 check point firewall-1 secure ftp server running on?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_MICROSOFT_FTP_SERVICE', 'description': 'is p20_ftp_banner_banner 220 microsoft ftp service?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_FTP_FIRMWARE_UPDATE_UTILITY', 'description': 'is p20_ftp_banner_banner 220 ftp firmware update utility?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_FTP_SERVICE_READY.', 'description': 'is p20_ftp_banner_banner 220 ftp service ready.?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_UNKNOWN', 'description': 'is p20_ftp_banner_banner unknown?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_FILEZILLA_SERVER_VERSION_0.9.41_BETA', 'description': 'is p20_ftp_banner_banner 220 filezilla server version 0.9.41 beta?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_PROFTPD', 'description': 'is p20_ftp_banner_banner 220 proftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_FTP_SERVER_READY.', 'description': 'is p20_ftp_banner_banner 220 ftp server ready.?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220-FILEZILLA_SERVER_0.9.60_BETA', 'description': 'is p20_ftp_banner_banner 220-filezilla server 0.9.60 beta?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220_(VSFTPD_', 'description': 'is p20_ftp_banner_banner 220 (vsftpd ?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_BANNER_220', 'description': 'is p20_ftp_banner_banner 220?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_CHECK_POINT', 'description': 'is p20_ftp_banner running check point?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_TITAN', 'description': 'is p20_ftp_banner running titan?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_PURE-FTPD', 'description': 'is p20_ftp_banner running pure-ftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_CRUSHFTP', 'description': 'is p20_ftp_banner running crushftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_NASLITE', 'description': 'is p20_ftp_banner running naslite?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_PROFTPD', 'description': 'is p20_ftp_banner running proftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_WS_FTP', 'description': 'is p20_ftp_banner running ws ftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_MICROSOFT', 'description': 'is p20_ftp_banner running microsoft?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_WU-FTPD', 'description': 'is p20_ftp_banner running wu-ftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_WAR', 'description': 'is p20_ftp_banner running war?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_FILEZILLA', 'description': 'is p20_ftp_banner running filezilla?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_SERV-U', 'description': 'is p20_ftp_banner running serv-u?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_BLAH', 'description': 'is p20_ftp_banner running blah?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_AMAZON', 'description': 'is p20_ftp_banner running amazon?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_VSFTPD', 'description': 'is p20_ftp_banner running vsftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_DREAMHOST', 'description': 'is p20_ftp_banner running dreamhost?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_GLFTPD', 'description': 'is p20_ftp_banner running glftpd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_NASFTP', 'description': 'is p20_ftp_banner running nasftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_CERBERUS', 'description': 'is p20_ftp_banner running cerberus?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_COMPLETEFTP', 'description': 'is p20_ftp_banner running completeftp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P20_FTP_BANNER_RUNNING_SYSAX', 'description': 'is p20_ftp_banner running sysax?'}])


if __name__ == "__main__":
    main()