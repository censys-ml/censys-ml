from scripts.analyze_data.lib.feature import Feature
from scripts.utils import get_field
from scripts.const import ports_and_protocols, ics_vendor_list
from u_utils import common_models


def meta_features(machine, field_prefix):
    res = []
    vendor_off_name = get_field(machine, '{}_vendor_official_name'.format(field_prefix), t='str')
    vendor_report_name = get_field(machine, '{}_vendor_reported_name'.format(field_prefix), t='str')
    desc = get_field(machine, '{}_description'.format(field_prefix), t='str')
    model = get_field(machine, '{}_model_name'.format(field_prefix), t='str')
    object_name = get_field(machine, '{}_object_name'.format(field_prefix), t='str')
    app_soft_rev = get_field(machine, '{}_application_software_revision'.format(field_prefix), t='str')

    add_str = ' '.join([desc, model, object_name, vendor_off_name, vendor_report_name, app_soft_rev])

    res += common_models(machine, field_prefix, ics_vendor_list, add_str=add_str)
    res += [
        Feature(as_obj={
            '_id': '{}_SUPPORT'.format(field_prefix),
            '_type': 'MACHINE',
            'expansion_safe': True,
            'value': get_field(machine, '{}_support'.format(field_prefix)),
            'description': 'this server '
                           'supports {}?'.format(field_prefix)
        }),
        Feature(as_obj={
            '_id': '{}_VENDOR_ID'.format(field_prefix),
            '_type': 'MACHINE',
            'expansion_safe': True,
            'value': get_field(machine, '{}_vendor_id'.format(field_prefix)),
            'description': 'vendor id for {}?'.format(field_prefix)
        }),
        Feature(as_obj={
            '_id': '{}_instance_number'.format(field_prefix),
            '_type': 'MACHINE',
            'expansion_safe': True,
            'value': get_field(machine, '{}_instance_number'.format(field_prefix)),
            'description': 'instance_number for {}?'.format(field_prefix)
        })
    ]
    return res


def extract(machine, args):
    # todo firmware_revision
    res = []
    protocol = 'bacnet'
    ports = [p for c in ports_and_protocols
             if c[0] == protocol
             for p in c[1]]
    for port in sorted(ports, reverse=True):
        prefix = 'p{}_{}_device_id'.format(port, protocol)
        res += meta_features(machine, prefix)
    return res


def main():
    import json
    from scripts.utils import recurse_machine_fields
    machine = recurse_machine_fields(json.loads("""{"p80":{"http":{"get":{"headers":{"unknown":[{"value":"Tue, 19 Mar 2019 03:22:47 GMT","key":"date"}],"expires":"Thu, 01 Jan 1970 00:00:00 GMT","server":"Niagara Web Server/3.8.41.1","content_type":"text/html; charset=UTF-8","x_frame_options":"sameorigin","cache_control":"no-cache, no-store"},"status_code":200,"title":"Login","status_line":"200 OK","body_sha256":"e87d9c54ac919837b466b1da5117400dbc9a07ec7c3570eec3bdceb25f673acd","metadata":{"product":"Niagara","description":"Niagara"}}}},"p1911":{"fox":{"device_id":{"vm_name":"Java HotSpot(TM) Client VM","os_name":"QNX","vm_version":"1.5.0_34-b29","app_name":"Station","language":"en","os_version":"6.4.1","auth_agent_type":"fox","support":true,"hostname":"67.40.40.145","time_zone":"America/Denver","brand_id":"FacExp","version":"1.0.1","vm_uuid":"11e8da1c-5cab-23b2-0000-000000009903","host_address":"67.40.40.145","sys_info":"bog 61[<bog version=1.0>","host_id":"Qnx-NPM6E-0000-1917-27F4","station_name":"S_Quebec_5500","app_version":"3.8.41.2","id":737,"metadata":{}}}},"p47808":{"bacnet":{"device_id":{"vendor":{"reported_name":"Tridium","id":36,"official_name":"Tridium Inc."},"firmware_revision":"3.8.41.2","support":true,"instance_number":1,"object_name":"S_Quebec_5500_1","application_software_revision":"Tridium 3.8.41.16","model_name":"NiagaraAX Station","metadata":{},"description":"Local BACnet Device object"}}},"ip":"67.40.40.145","tags":["NPM","scada server","http","fox","scada","bacnet","NPM6","building control"],"updated_at":"2019-03-20T02:08:57+00:00","autonomous_system":{"description":"CENTURYLINK-US-LEGACY-QWEST - CenturyLink Communications, LLC","rir":"unknown","routed_prefix":"67.40.0.0/15","country_code":"US","path":[7018,209],"asn":209,"name":"CENTURYLINK-US-LEGACY-QWEST - CenturyLink Communications, LLC"},"location":{"country":"United States","longitude":-104.9312,"registered_country":"United States","registered_country_code":"US","country_code":"US","latitude":39.7086,"timezone":"America/Denver","continent":"North America","province":"Colorado","city":"Denver","postal_code":"80246"},"ports":[47808,80,1911],"protocols":["80/http","1911/fox","47808/bacnet"],"metadata":{"device_type":"scada server","product":"NiagaraAX Station","description":"Tridium NiagaraAX Station","manufacturer":"Tridium","os":"QNX","os_description":"QNX"}}"""))
    args = {}
    result = extract(machine, args)
    # print([r.get_all() for r in result])
    from scripts.utils import compare_feature_output
    compare_feature_output([r.get_all() for r in result], [{'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SEROTONIN_SOFTWARE_TECHNOLOGIES,_INC.', 'description': 'is p47808_bacnet_device_id running serotonin software technologies, inc.?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_APPL_SW_VERS', 'description': 'is p47808_bacnet_device_id running appl_sw_vers?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MPWS', 'description': 'is p47808_bacnet_device_id running mpws?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_TREND_CONTROL', 'description': 'is p47808_bacnet_device_id running trend control?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EBCON', 'description': 'is p47808_bacnet_device_id running ebcon?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_7.0', 'description': 'is p47808_bacnet_device_id running 7.0?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_7.7', 'description': 'is p47808_bacnet_device_id running 7.7?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_6.1', 'description': 'is p47808_bacnet_device_id running 6.1?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_6.0', 'description': 'is p47808_bacnet_device_id running 6.0?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_AUTOMATED_LOGIC_CORPORATION', 'description': 'is p47808_bacnet_device_id running automated logic corporation?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WEBCTRL_SERVER', 'description': 'is p47808_bacnet_device_id running webctrl server?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_I/O_PRO', 'description': 'is p47808_bacnet_device_id running i/o pro?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_V4.40', 'description': 'is p47808_bacnet_device_id running v4.40?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WEBCTRL_SUPERSET', 'description': 'is p47808_bacnet_device_id running webctrl superset?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WEB_CONTR._01', 'description': 'is p47808_bacnet_device_id running web contr. 01?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_I-VU_PLUS', 'description': 'is p47808_bacnet_device_id running i-vu plus?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_RELIABLE_CONTROLS', 'description': 'is p47808_bacnet_device_id running reliable controls?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BROADWIN', 'description': 'is p47808_bacnet_device_id running broadwin?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MAITRE', 'description': 'is p47808_bacnet_device_id running maitre?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_2.15', 'description': 'is p47808_bacnet_device_id running 2.15?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_2.12', 'description': 'is p47808_bacnet_device_id running 2.12?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_2.10', 'description': 'is p47808_bacnet_device_id running 2.10?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_UNINITIALIZED', 'description': 'is p47808_bacnet_device_id running uninitialized?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_ELNET_LT', 'description': 'is p47808_bacnet_device_id running elnet lt?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MPC', 'description': 'is p47808_bacnet_device_id running mpc?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SIGMATEK', 'description': 'is p47808_bacnet_device_id running sigmatek?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SIEMENS', 'description': 'is p47808_bacnet_device_id running siemens?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_REGIN', 'description': 'is p47808_bacnet_device_id running regin?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EASYIO', 'description': 'is p47808_bacnet_device_id running easyio?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WC18', 'description': 'is p47808_bacnet_device_id running wc18?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_COMPASS', 'description': 'is p47808_bacnet_device_id running compass?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WC17', 'description': 'is p47808_bacnet_device_id running wc17?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SERVERAAM-ROUTER', 'description': 'is p47808_bacnet_device_id running serveraam-router?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DESC', 'description': 'is p47808_bacnet_device_id running desc?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CONTEMPORARY.', 'description': 'is p47808_bacnet_device_id running contemporary.?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MCQUAY_INTERNATIONAL', 'description': 'is p47808_bacnet_device_id running mcquay international?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_NOVAR_CORP./TREND_CONTROL_SYSTEMS_LTD.', 'description': 'is p47808_bacnet_device_id running novar corp./trend control systems ltd.?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BCM-ETH_CONTROLLER', 'description': 'is p47808_bacnet_device_id running bcm-eth controller?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_V4.30', 'description': 'is p47808_bacnet_device_id running v4.30?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_6.5', 'description': 'is p47808_bacnet_device_id running 6.5?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SCADA_ENGINE', 'description': 'is p47808_bacnet_device_id running scada engine?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EMS500-LITE-SCHEDU', 'description': 'is p47808_bacnet_device_id running ems500-lite-schedu?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_PROVIEW', 'description': 'is p47808_bacnet_device_id running proview?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_RG-XXCS', 'description': 'is p47808_bacnet_device_id running rg-xxcs?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BACNET_HVAC_CONTROLLER', 'description': 'is p47808_bacnet_device_id running bacnet hvac controller?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CONPOWER', 'description': 'is p47808_bacnet_device_id running conpower?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_RLE_TECHNOLOGIES', 'description': 'is p47808_bacnet_device_id running rle technologies?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CENTRAWEB', 'description': 'is p47808_bacnet_device_id running centraweb?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_N/A', 'description': 'is p47808_bacnet_device_id running n/a?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_141223', 'description': 'is p47808_bacnet_device_id running 141223?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_2.8', 'description': 'is p47808_bacnet_device_id running 2.8?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DAIKIN', 'description': 'is p47808_bacnet_device_id running daikin?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_3.1', 'description': 'is p47808_bacnet_device_id running 3.1?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_2.0', 'description': 'is p47808_bacnet_device_id running 2.0?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_2.6', 'description': 'is p47808_bacnet_device_id running 2.6?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_2.4', 'description': 'is p47808_bacnet_device_id running 2.4?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_ABB', 'description': 'is p47808_bacnet_device_id running abb?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_KMC', 'description': 'is p47808_bacnet_device_id running kmc?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_IQ3XCITE', 'description': 'is p47808_bacnet_device_id running iq3xcite?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CUSTOM_SOFTWARE_ENGINEERING', 'description': 'is p47808_bacnet_device_id running custom software engineering?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_KOMFOVENT', 'description': 'is p47808_bacnet_device_id running komfovent?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CORRIGOVENTILATION', 'description': 'is p47808_bacnet_device_id running corrigoventilation?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_TRIDIUM', 'description': 'is p47808_bacnet_device_id running tridium?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CENK_GOCER', 'description': 'is p47808_bacnet_device_id running cenk gocer?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WEBCTRL_249999', 'description': 'is p47808_bacnet_device_id running webctrl 249999?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EAGLE', 'description': 'is p47808_bacnet_device_id running eagle?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_ENS-1', 'description': 'is p47808_bacnet_device_id running ens-1?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SMARTSTRUXURE', 'description': 'is p47808_bacnet_device_id running smartstruxure?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WEBCTRL_PREMIUM', 'description': 'is p47808_bacnet_device_id running webctrl premium?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_AMERICAN_AUTO-MATRIX', 'description': 'is p47808_bacnet_device_id running american auto-matrix?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_FG+_SERIES_BACNET_DEVICE', 'description': 'is p47808_bacnet_device_id running fg+ series bacnet device?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_AMALVA', 'description': 'is p47808_bacnet_device_id running amalva?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_VERIZONZIGBEE', 'description': 'is p47808_bacnet_device_id running verizonzigbee?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BOILER_ROOM', 'description': 'is p47808_bacnet_device_id running boiler room?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_I-VU_STANDARD', 'description': 'is p47808_bacnet_device_id running i-vu standard?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_050623', 'description': 'is p47808_bacnet_device_id running 050623?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_AIRTEK_', 'description': 'is p47808_bacnet_device_id running airtek ?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DEV2401', 'description': 'is p47808_bacnet_device_id running dev2401?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EMBEDDED_SYSTEMS_SIA', 'description': 'is p47808_bacnet_device_id running embedded systems sia?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BACNET_DEVICE', 'description': 'is p47808_bacnet_device_id running bacnet device?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_FIELDSERVER', 'description': 'is p47808_bacnet_device_id running fieldserver?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_TRACER', 'description': 'is p47808_bacnet_device_id running tracer?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_OPTERGY', 'description': 'is p47808_bacnet_device_id running optergy?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CARRIER', 'description': 'is p47808_bacnet_device_id running carrier?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_ROUTER', 'description': 'is p47808_bacnet_device_id running router?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_POWERHAWK_METER', 'description': 'is p47808_bacnet_device_id running powerhawk meter?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CONTROL', 'description': 'is p47808_bacnet_device_id running control?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_ASPECT_ROUTER', 'description': 'is p47808_bacnet_device_id running aspect router?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_130730', 'description': 'is p47808_bacnet_device_id running 130730?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_LOCAL_BACNET_DEVICE_OBJECT', 'description': 'is p47808_bacnet_device_id running local bacnet device object?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CONQUEST', 'description': 'is p47808_bacnet_device_id running conquest?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_POWER_METER', 'description': 'is p47808_bacnet_device_id running power meter?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MPWC', 'description': 'is p47808_bacnet_device_id running mpwc?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_POWER_FACTOR_CONTROLLER', 'description': 'is p47808_bacnet_device_id running power factor controller?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_V3.40', 'description': 'is p47808_bacnet_device_id running v3.40?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SOLARE', 'description': 'is p47808_bacnet_device_id running solare?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_ADVANTECH', 'description': 'is p47808_bacnet_device_id running advantech?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SCS_SA', 'description': 'is p47808_bacnet_device_id running scs sa?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SCL_ELEMENTS', 'description': 'is p47808_bacnet_device_id running scl elements?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_I-VU', 'description': 'is p47808_bacnet_device_id running i-vu?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_PV19', 'description': 'is p47808_bacnet_device_id running pv19?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BASRT-B', 'description': 'is p47808_bacnet_device_id running basrt-b?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_CAREL', 'description': 'is p47808_bacnet_device_id running carel?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_NIAGARAAX', 'description': 'is p47808_bacnet_device_id running niagaraax?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_ALERTON', 'description': 'is p47808_bacnet_device_id running alerton?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_UNKNOWNAB_REGIN', 'description': 'is p47808_bacnet_device_id running unknownab regin?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_V2.2.1', 'description': 'is p47808_bacnet_device_id running v2.2.1?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_OBVIUS', 'description': 'is p47808_bacnet_device_id running obvius?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_NIAGARA4', 'description': 'is p47808_bacnet_device_id running niagara4?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_LOGICMACHINE', 'description': 'is p47808_bacnet_device_id running logicmachine?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_PCO1000WB0', 'description': 'is p47808_bacnet_device_id running pco1000wb0?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SCS_SWISS_CONTROL_SYSTEMS', 'description': 'is p47808_bacnet_device_id running scs swiss control systems?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DELTA', 'description': 'is p47808_bacnet_device_id running delta?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_FP-WEBSERVER', 'description': 'is p47808_bacnet_device_id running fp-webserver?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MITSUBISHI', 'description': 'is p47808_bacnet_device_id running mitsubishi?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_PV17', 'description': 'is p47808_bacnet_device_id running pv17?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BACNET/IP_TO_MS/TP_ROUTER', 'description': 'is p47808_bacnet_device_id running bacnet/ip to ms/tp router?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_PCOWEB770000.0', 'description': 'is p47808_bacnet_device_id running pcoweb770000.0?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_TRANE', 'description': 'is p47808_bacnet_device_id running trane?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_FP-MB-TCP', 'description': 'is p47808_bacnet_device_id running fp-mb-tcp?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EATON', 'description': 'is p47808_bacnet_device_id running eaton?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_TRIACTA', 'description': 'is p47808_bacnet_device_id running triacta?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DEFAULT_DESCRIPTION', 'description': 'is p47808_bacnet_device_id running default description?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_KIEBACK_&_PETER', 'description': 'is p47808_bacnet_device_id running kieback & peter?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_1.4', 'description': 'is p47808_bacnet_device_id running 1.4?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DISTECH_CON', 'description': 'is p47808_bacnet_device_id running distech con?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_1.0', 'description': 'is p47808_bacnet_device_id running 1.0?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_1.2', 'description': 'is p47808_bacnet_device_id running 1.2?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_0.5', 'description': 'is p47808_bacnet_device_id running 0.5?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WEBCTRL_500', 'description': 'is p47808_bacnet_device_id running webctrl 500?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WC20', 'description': 'is p47808_bacnet_device_id running wc20?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_TAC', 'description': 'is p47808_bacnet_device_id running tac?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MACH-PRO', 'description': 'is p47808_bacnet_device_id running mach-pro?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_IQ4E', 'description': 'is p47808_bacnet_device_id running iq4e?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_FPWEBD', 'description': 'is p47808_bacnet_device_id running fpwebd?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_UNITED', 'description': 'is p47808_bacnet_device_id running united?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_NAE', 'description': 'is p47808_bacnet_device_id running nae?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_LOYTEC_ELECTRONICS', 'description': 'is p47808_bacnet_device_id running loytec electronics?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_HONEYWELL', 'description': 'is p47808_bacnet_device_id running honeywell?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_PANASONIC', 'description': 'is p47808_bacnet_device_id running panasonic?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_JCI', 'description': 'is p47808_bacnet_device_id running jci?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BACNET_STACK_AT_SOURCEFORGE', 'description': 'is p47808_bacnet_device_id running bacnet stack at sourceforge?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_FR._SAUTER', 'description': 'is p47808_bacnet_device_id running fr. sauter?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SAUTER', 'description': 'is p47808_bacnet_device_id running sauter?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_REGO', 'description': 'is p47808_bacnet_device_id running rego?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_MATRIX-RTR', 'description': 'is p47808_bacnet_device_id running matrix-rtr?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DEVICE', 'description': 'is p47808_bacnet_device_id running device?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EBMGR', 'description': 'is p47808_bacnet_device_id running ebmgr?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_EMERSON_NETWORK_POWER', 'description': 'is p47808_bacnet_device_id running emerson network power?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_BNR01', 'description': 'is p47808_bacnet_device_id running bnr01?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_JOHNSON_CONTROLS', 'description': 'is p47808_bacnet_device_id running johnson controls?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_SCHNEIDER', 'description': 'is p47808_bacnet_device_id running schneider?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_DENT', 'description': 'is p47808_bacnet_device_id running dent?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_NEUBERGER', 'description': 'is p47808_bacnet_device_id running neuberger?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 0.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_RUNNING_WC19', 'description': 'is p47808_bacnet_device_id running wc19?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_SUPPORT', 'description': 'this server supports p47808_bacnet_device_id?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 36.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_VENDOR_ID', 'description': 'vendor id for p47808_bacnet_device_id?'}, {'_type': 'MACHINE', 'descriptive': False, 'value': 1.0, 'expansion_safe': True, '_id': 'P47808_BACNET_DEVICE_ID_INSTANCE_NUMBER', 'description': 'instance_number for p47808_bacnet_device_id?'}])


if __name__ == '__main__':
    main()